# =============================================================================
# jdoo - Universal Odoo Docker Environment
# =============================================================================
# Works with both ./jdoo wrapper (local dev) and plain docker compose (Dokploy).
#
# Local development:
#   cp .env.example .env && nano .env
#   ./jdoo up -d --build          # auto-computes PYTHON_VERSION, PG_VERSION, etc.
#
# Dokploy / direct docker compose:
#   Set ODOO_VERSION, then run: bash compute-env.sh && docker compose up -d --build
#   compute-env.sh auto-computes PYTHON_VERSION + PG_VERSION from ODOO_VERSION
# =============================================================================

# =============================================================================
# VERSION MATRIX
# =============================================================================
# Set ODOO_VERSION (required). The rest is auto-computed by ./jdoo or compute-env.sh.
#
#  ODOO_VERSION | PYTHON_VERSION | PG_VERSION | ODOO_PORT* | COMPOSE_PROJECT_NAME*
# --------------|----------------|------------|------------|----------------------
#  15.0         | 3.10           | 14         | 8015       | jdoo15
#  16.0         | 3.10           | 15         | 8016       | jdoo16
#  17.0         | 3.12           | 16         | 8017       | jdoo17
#  18.0         | 3.12           | 16         | 8018       | jdoo18
#  19.0         | 3.12 (default) | 17 (default)| 8019      | jdoo19
#
# * ODOO_PORT and COMPOSE_PROJECT_NAME are only auto-computed by ./jdoo.
#   For Dokploy, ODOO_PORT defaults to 8069 (Dokploy reverse proxy handles it).
# =============================================================================

# -----------------------------------------------------------------------------
# Odoo Version (required)
# -----------------------------------------------------------------------------
ODOO_VERSION=19.0

# -----------------------------------------------------------------------------
# Version-dependent settings (auto-computed by ./jdoo or compute-env.sh)
# Uncomment to override the auto-computed values
# -----------------------------------------------------------------------------
#PYTHON_VERSION=3.12
#PG_VERSION=17
#ODOO_PORT=8069
#COMPOSE_PROJECT_NAME=jdoo

# -----------------------------------------------------------------------------
# Odoo Source Repository
# -----------------------------------------------------------------------------
# Default: autocme/oc (optimized minimal core, ~80% smaller)
# Alternative: https://github.com/odoo/odoo.git (official, much larger)
ODOO_REPO=https://github.com/autocme/oc.git

# -----------------------------------------------------------------------------
# Security - CHANGE THESE IN PRODUCTION!
# -----------------------------------------------------------------------------
POSTGRES_USER=odoo
POSTGRES_PASSWORD=odoo
ODOO_ADMIN_PASSWORD=admin_

# -----------------------------------------------------------------------------
# Container Configuration
# -----------------------------------------------------------------------------
LONGPOLLING_PORT=8072

# User/Group IDs (match host user for volume permissions)
PUID=1000
PGID=1000

# -----------------------------------------------------------------------------
# Resource Allocation (auto-computed inside containers)
# -----------------------------------------------------------------------------
# Odoo workers (auto: CPU * 2, min 2)
#WORKERS=

# Cron threads (auto: 1 if workers < 6, else 2)
#MAX_CRON_THREADS=

# Per-worker memory limits in bytes (auto: based on available RAM)
#LIMIT_MEMORY_SOFT=
#LIMIT_MEMORY_HARD=

# Resource watcher - monitors CPU/RAM changes and restarts Odoo (TRUE/FALSE)
#RESOURCE_WATCHER=FALSE

# -----------------------------------------------------------------------------
# PostgreSQL Tuning (auto-computed inside PG container from RAM)
# Override any value here to skip auto-computation for that setting.
# -----------------------------------------------------------------------------
#PG_SHARED_BUFFERS=
#PG_EFFECTIVE_CACHE_SIZE=
#PG_WORK_MEM=64MB
#PG_MAINTENANCE_WORK_MEM=
#PG_MAX_CONNECTIONS=100

# -----------------------------------------------------------------------------
# Odoo Features
# -----------------------------------------------------------------------------
# Auto-upgrade modules on container restart (TRUE/FALSE)
AUTO_UPGRADE=FALSE

# Skip Odoo core addons during upgrade (TRUE/FALSE)
# TRUE = faster, only upgrades custom/third-party addons
UPGRADE_IGNORE_CORE=TRUE

# Fix report.url for wkhtmltopdf PDF rendering inside the container (TRUE/FALSE)
# When TRUE, sets report.url = http://localhost:<port> in all databases
# so wkhtmltopdf can fetch CSS/JS assets locally for PDF generation
FIX_REPORT_URL=FALSE

# Database initialization options (empty = disabled, create DB from Odoo UI)
# Example: "-n odoo_prod -m base,web --unless-initialized"
INITDB_OPTIONS=

# Target database name (empty = auto-detect first non-system DB)
ODOO_DB_NAME=

# -----------------------------------------------------------------------------
# Runtime Package Installation
# -----------------------------------------------------------------------------
# Python packages (comma-separated, checked on each startup)
PY_INSTALL=phonenumbers,python-stdnum,num2words

# NPM packages (comma-separated, checked on each startup)
NPM_INSTALL=rtlcss,less

# -----------------------------------------------------------------------------
# GitHubSyncer Integration (optional)
# -----------------------------------------------------------------------------
# To use GitHubSyncer, create a docker-compose.override.yml:
#   services:
#     odoo:
#       volumes:
#         - githubsyncer_repo_storage:/mnt/synced-addons:ro
#   volumes:
#     githubsyncer_repo_storage:
#       external: true
